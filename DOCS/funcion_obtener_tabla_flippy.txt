CREATE OR REPLACE FUNCTION public.obtener_tabla_flippy(p_level integer)
RETURNS TABLE (
    id text,
    nivel smallint,
    nombre text,
    pais text,
    ciudad text,
    puntos smallint,
    partidas smallint,
    tiempo_record smallint,
    tiempo_total integer,
    actualizado text,
    ganadas smallint,
    perdidas smallint
)
LANGUAGE plpgsql
SECURITY DEFINER
SET search_path = public
AS $$
BEGIN
  RETURN QUERY
  SELECT 
    f.id,
    f.nivel,
    f.nombre,
    f.pais,
    f.ciudad,
    f.puntos,
    f.partidas,
    f.tiempo_record,
    f.tiempo_total,
    f.actualizado,
    f.ganadas,
    f.perdidas
  FROM public.flippy_points f
  where f.nivel = p_level
  ORDER BY f.puntos desc;
END;
$$;